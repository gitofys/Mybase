# 版本 1.0.0 发布说明

## 发布日期
2025-12-06

## 版本信息
- **版本号**: 1.0.0
- **版本代码**: 1
- **Git标签**: v1.0.0
- **Git提交**: 911f4a8

## 主要功能更新

### 1. 图表显示优化
- ✅ X轴显示波长范围（900~1700 nm），不再转换为波数
- ✅ Y轴根据数据范围自动调整，添加10%边距
- ✅ 坐标轴标签正常显示（文本大小12f，黑色）
- ✅ 图表描述显示坐标轴信息
- ✅ 无数据时显示y=0的直线，Y轴范围自动调整为-100到100

### 2. 参考数据绘制
- ✅ 下载参考校准数据后自动绘制参考图线
- ✅ 连接失败时显示y=0的直线
- ✅ 图表初始化时显示占位线

### 3. 扫描按钮状态管理
- ✅ **未连接**: 灰色锁定状态（不可点击）
- ✅ **已连接**: 红色可点击状态
- ✅ **扫描中**: 绿色状态，显示"扫描中..."
- ✅ **扫描完成**: 恢复为红色状态
- ✅ **断开连接**: 恢复为灰色锁定状态

### 4. Android 12+ 权限修复
- ✅ 修复Android 12+蓝牙权限问题（BLUETOOTH_SCAN和BLUETOOTH_CONNECT）
- ✅ 添加权限请求结果处理
- ✅ 在服务连接时检查权限，避免崩溃

### 5. UI优化
- ✅ 合并"设备信息"和"设备状态"为一个按钮
- ✅ 灯控制移至配置页面，支持三种模式（打开/关闭/自动）
- ✅ 优化设备状态页面布局

### 6. 代码优化
- ✅ 所有Activity文件添加中文注释
- ✅ 清理无用视图和布局文件
- ✅ 简化SettingsViewActivity，移除冗余功能

## 技术改进

### 权限管理
- Android 12+ (API 31+) 使用新的蓝牙权限模型
- 运行时权限请求和处理
- 权限授予后自动恢复扫描流程

### 图表库
- 使用MPAndroidChart库
- 自定义坐标轴格式化器
- 动态Y轴范围调整

### 状态管理
- 按钮状态与连接状态同步
- 扫描状态可视化反馈

## 已知问题
- 无

## 打包说明

### 使用Android Studio打包
1. 打开项目
2. 选择 Build -> Generate Signed Bundle / APK
3. 选择 APK
4. 选择或创建签名密钥
5. 选择 release 构建变体
6. 完成打包

### 使用命令行打包
```bash
# Windows (需要安装Git Bash或WSL)
./gradlew assembleRelease

# 或使用gradle命令（如果已安装）
gradle assembleRelease
```

### APK位置
打包完成后，APK文件位于：
```
app/build/outputs/apk/release/app-release.apk
```

## Git备份信息

### 提交信息
- **提交哈希**: 911f4a8
- **提交消息**: 版本1.0.0: 完成图表优化、按钮状态管理、权限修复等主要功能
- **修改文件**: 13个文件
- **新增行数**: 1268行
- **删除行数**: 420行

### 标签信息
- **标签名**: v1.0.0
- **标签消息**: 版本1.0.0: 完整功能版本，包含图表优化、按钮状态管理、Android 12+权限修复

### 远程仓库
- **远程名称**: nir_Android
- **仓库地址**: https://github.com/gitofys/Mybase.git

## 推送命令

```bash
# 推送代码到远程仓库
git push nir_Android master

# 推送标签到远程仓库
git push nir_Android v1.0.0
```

## 测试建议

### 功能测试
1. ✅ 图表显示（X轴波长、Y轴自动调整）
2. ✅ 参考数据绘制
3. ✅ 扫描按钮状态切换
4. ✅ 蓝牙连接和扫描
5. ✅ 权限请求（Android 12+）

### 设备测试
- ✅ 小米15真机测试（Android 12+）
- ⚠️ 其他Android版本设备测试

## 后续计划
- 持续优化用户体验
- 根据用户反馈进行改进
- 性能优化

## 联系方式
如有问题或建议，请联系开发团队。

